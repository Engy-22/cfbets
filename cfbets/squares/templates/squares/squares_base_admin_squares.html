{% extends "squares_base.html" %}

{% block extra_head %}
{% endblock %}

{% block base_content %}
<div class="container">
    <h1>Admin Squares!</h1>

    <button class='btn btn-success' data-toggle="modal" data-target="#newGameModal">
        New Game</button>

    <div class="container">
        <h3>Active Squares</h3>
        <p>These are all the open squares games that have not been marked as
        "complete" by the admin".

                <!-- Table -->
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th></th>
                        <th>Team A</th>
                        <th>Team B</th>
                        <th>PPS</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="v-center-square">
                        <th scope="row"><button class="btn btn-primary">View</button></th>
                            <td>Clemson</td>
                            <td>Uscjr</td>
                            <td>$1</td>
                    </tr>
                    <tr>
                        <th scope="row"><button class="btn btn-primary">View</button></th>
                            <td>Clemson</td>
                            <td>Uscjr</td>
                            <td>$1</td>
                    </tr>
                    </tbody>
                </table>
    </div>

    <div class="container">
        <h3>Closed Squares</h3>
        {% if all_closed_squares %}
            <p>These are all the games that have already completed and have
            winners marked.</p>
        {% else %}
            <p>Exactly zero closed squares games. We must just be getting started.</p>
            <p>Let's try to create a sample squares view, because I don't feel
            like doing anything hard while drinking woodford on a plane.</p>

                <!-- Table -->
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th></th>
                        <th>Team A</th>
                        <th>Team B</th>
                        <th>PPS</th>
                        <th>Shits</th>
                        <th>Q1,Q2,Q3,Q4</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="v-center-square">
                        <th scope="row"><button class="btn btn-warning">Undo</button></th>
                            <td>Clemson</td>
                            <td>Uscjr</td>
                            <td>$1</td>
                            <td>Josh P, Kris J, John T</td>
                            <td>Matt S, Bobby C, Brandon B, Grey P</td>
                    </tr>
                    <tr>
                        <th scope="row"><button class="btn btn-warning">Undo</button></th>
                            <td>Clemson</td>
                            <td>Uscjr</td>
                            <td>$1</td>
                            <td>Josh P, Kris J, John T</td>
                            <td>Matt S, Bobby C, Brandon B, Grey P</td>
                    </tr>
                    </tbody>
                </table>

        {% endif %}
    </div>

</div>

<!-- New Squares Game form modal -->
<div class="modal fade" id="newGameModal" tabindex="-1" role="dialog" aria-labelledby="newGameModalLabel">
    <div class="modal-dialog" role="document">
    	<div class="modal-content">
    		<div class="modal-header">
    			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    			<h4 class="modal-title" id="NewGame">New Game</h4>
			</div>

			<div class="modal-body">
				{% include "squares/new_game.html" %}
			</div>

			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="submit" id="new-game-btn" class="btn btn-primary" form="new-game-form">Add Game</button>
			</div>
        </div>
    </div>
</div>

{% endblock %}

{% block morejs %}
	$('#newGameModal').on('show.bs.modal', function () {
		var d = new Date();
		d.setDate(d.getDate() + 7)
		var curr_date = d.getDate();
		var curr_month = d.getMonth() + 1;
		var curr_year = d.getFullYear();
		$('#id_squares_expiration_date').val(curr_month + "/" + curr_date + "/" + curr_year + " 12:00");
	});

	$('#new-game-form').on('submit', function(event) {
		event.preventDefault();
		});

	$('#new-game-form').one('submit', function(event) {
		event.preventDefault();
		$.ajax({
			type: "POST",
			url: this.action,
			data: $(this).serialize(),
			context: this,
			success: function(data, status) {
            window.location.href = data.url;
			},
			error: function(xhr, status, error) {
				$("#new-game-form").html(xhr.responseText);
			}
		});
		return false;
		});

{% endblock %}
